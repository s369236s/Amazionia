(()=>{"use strict";class e{constructor(e){this.element=new Image,this.element.src=e}}class t{constructor(t,s,i){this.image=new e(i),this.pos=[t,s]}render(e){e.drawImage(this.image.element,this.pos[0],this.pos[1])}}class s{constructor(){s.clickPos=[0,0],s.mousemovePos=[0,0]}clickListener(e){e.addEventListener("click",(t=>{s.clickPos=[t.clientX-e.getBoundingClientRect().left,t.clientY-e.getBoundingClientRect().top];const[i,n]=s.clickPos;console.log(`${Math.floor(i)},${Math.floor(n)}`)}))}mouseoverListener(e){e.addEventListener("mousemove",(t=>{s.mousemovePos[0]=t.clientX-e.getBoundingClientRect().left,s.mousemovePos[1]=t.clientY-e.getBoundingClientRect().top}))}}class i{}i.current=0,i.menu=0,i.home=1,i.map=2,i.river=3,i.jungle=4,i.waterfall=5;class n{constructor(t,s,i,n=!1,r="",o=!1,h=99){this.image=new e(i),this.imageURL=i,this.image.element.src=i,this.isHoverAble=n,this.isChangeSenceAble=o,this.gotoSence=h,this.imageHoverURL=r,this.pos=[t,s]}render(e){e.drawImage(this.image.element,this.pos[0]-this.image.element.width/2,this.pos[1]-this.image.element.height/2),this.isHoverAble&&(s.mousemovePos[0]>this.pos[0]-this.image.element.width/2&&s.mousemovePos[1]>this.pos[1]-this.image.element.height/2&&s.mousemovePos[0]<this.pos[0]+this.image.element.width/2&&s.mousemovePos[1]<this.pos[1]+this.image.element.height/2?this.image.element.src=this.imageHoverURL:this.image.element.src=this.imageURL),this.isChangeSenceAble&&s.clickPos[0]>this.pos[0]-this.image.element.width/2&&s.clickPos[1]>this.pos[1]-this.image.element.height/2&&s.clickPos[0]<this.pos[0]+this.image.element.width/2&&s.clickPos[1]<this.pos[1]+this.image.element.height/2&&(i.current=this.gotoSence)}}class r{constructor(){this.background=new t(0,0,"./Media/Image/Backgrounds/menu.png"),this.startButton=new n(N.width/2,N.height/2,"./Media/Image/UI/Button/New-Game-Button.png",!0,"./Media/Image/UI/Button/New-Game-Button-Hover.png",!0,1)}render(e){this.background.render(e),this.startButton.render(e)}}class o{constructor(t,s,i,n,r,o){this.pos=[t,s],this.imageURL=i,this.attrValue=n,this.isHoverAble=r,this.imageHoverURL=o,this.image=new e(i)}render(e){e.drawImage(this.image.element,this.pos[0]-this.image.element.width/2,this.pos[1]-this.image.element.height/2),e.fillStyle="white",e.font="16px Poppins",e.textAlign="center",e.fillText(this.attrValue.toString(),this.image.element.width+this.pos[0]-this.image.element.width/2+15,60),this.isHoverAble&&(s.mousemovePos[0]>this.pos[0]-this.image.element.width/2&&s.mousemovePos[1]>this.pos[1]-this.image.element.height/2&&s.mousemovePos[0]<this.pos[0]+this.image.element.width/2&&s.mousemovePos[1]<this.pos[1]+this.image.element.height/2?this.image.element.src=this.imageHoverURL:this.image.element.src=this.imageURL)}}class h{constructor(){this.health=new o(30,60,"./Media/Image/UI/Attr/health.png",100,!0,"./Media/Image/UI/Attr/health-hover.png"),this.hunger=new o(100,60,"./Media/Image/UI/Attr/hunger.png",100,!0,"./Media/Image/UI/Attr/hunger-hover.png"),this.thirsty=new o(170,60,"./Media/Image/UI/Attr/thirsty.png",100,!0,"./Media/Image/UI/Attr/thirsty-hover.png"),this.mentality=new o(240,60,"./Media/Image/UI/Attr/mentality.png",100,!0,"./Media/Image/UI/Attr/mentality-hover.png")}render(e){this.health.render(e),this.hunger.render(e),this.thirsty.render(e),this.mentality.render(e)}}class a{}a.day=0,a.minute=1430;class m{constructor(){this.pos=[0,0],this.day=a.day,this.hour=Math.floor(a.minute%525600%1440/60),this.minute=Math.floor(a.minute%525600%1440%60/24)}secondsToString(e){return this.hour=Math.floor(e%525600%1440/60),this.minute=Math.floor(e%525600%1440%60),`${this.hour<10?`0${this.hour.toString()}`:this.hour.toString()}:${this.minute<10?`0${this.minute.toString()}`:this.minute.toString()} `}render(e){e.save(),e.fillStyle="#47defc",e.font="600 30px digital",e.textAlign="center",e.fillText(this.secondsToString(a.minute),350,65),e.restore(),e.save(),e.fillStyle="white",e.font="15px Poppins",e.textAlign="center",e.fillText(`Day : ${a.day.toString()}`,367.5,80),e.restore()}}class g{}g.current=0,g.none=0,g.guide=1,g.bag=2,g.tent=3,g.fire=4;class c{constructor(t,s,i,n=!1,r="",o=!1,h=99,a=!1,m=99,g="none"){this.panelOpen=99,this.image=new e(i),this.imageURL=i,this.image.element.src=i,this.isHoverAble=n,this.imageHoverURL=r,this.isOpenPanelable=o,this.panelOpen=h,this.isChangeSenceAble=a,this.gotoSence=m,this.pos=[t,s],this._objectName_test=g}render(e){e.save(),g.current!==g.none&&"none"===this._objectName_test||(this.isOpenPanelable?s.clickPos[0]>this.pos[0]-this.image.element.width/2&&s.clickPos[1]>this.pos[1]-this.image.element.height/2&&s.clickPos[0]<this.pos[0]+this.image.element.width/2&&s.clickPos[1]<this.pos[1]+this.image.element.height/2&&(s.clickPos=[0,0],g.current=this.panelOpen):this.isChangeSenceAble&&s.clickPos[0]>this.pos[0]-this.image.element.width/2&&s.clickPos[1]>this.pos[1]-this.image.element.height/2&&s.clickPos[0]<this.pos[0]+this.image.element.width/2&&s.clickPos[1]<this.pos[1]+this.image.element.height/2&&(s.clickPos=[0,0],i.current=this.gotoSence),this.isHoverAble&&(s.mousemovePos[0]>this.pos[0]-this.image.element.width/2&&s.mousemovePos[1]>this.pos[1]-this.image.element.height/2&&s.mousemovePos[0]<this.pos[0]+this.image.element.width/2&&s.mousemovePos[1]<this.pos[1]+this.image.element.height/2?e.globalAlpha=.7:e.globalAlpha=1)),e.drawImage(this.image.element,this.pos[0]-this.image.element.width/2,this.pos[1]-this.image.element.height/2),e.restore()}}class l extends c{constructor(){super(364,149,"./Media/Image/UI/Guide-Icon.png",!0,void 0,!0,g.guide)}render(e){super.render(e)}}class d{constructor(){this.background=new t(0,0,"./Media/Image/Backgrounds/home.png"),this.tent=new c(80,465,"./Media/Image/SenceObjects/tent.png",!0,void 0,!0,g.tent),this.fire=new c(190,540,"./Media/Image/SenceObjects/fire.png",!0,void 0,!0,g.fire),this.bag=new c(350,445,"./Media/Image/SenceObjects/bag.png",!0,void 0,!0,g.bag),this.leaveArrow=new c(70,220,"./Media/Image/UI/Leave-Arrow.png",!0,void 0,void 0,void 0,!0,i.map)}render(e){this.background.render(e),this.fire.render(e),this.tent.render(e),this.leaveArrow.render(e),this.bag.render(e)}}class u{}u.current=1,u.home=1,u.river=3,u.jungle=4,u.waterfall=5,u.mapPos=[];class p{constructor(t,s,i=!1,n=!1,r=99,o=""){this.pos=[t[0],t[1]],this.imageURL=s,this.isHoverAble=i,this.isChangeSenceAble=n,this.gotoSence=r,this.senceName=o,this.image=new e(s),u.mapPos.push([t[0],t[1],this.senceName])}calculateCost(e,t){const s=Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2));return Math.round(s)}debug(){console.log(`${u.mapPos[u.current][2]} ${u.mapPos[u.current][0]},${u.mapPos[u.current][1]}`,`${u.mapPos[this.gotoSence][2]} ${u.mapPos[this.gotoSence][0]},${u.mapPos[this.gotoSence][1]}`,"distance = "+this.calculateCost([u.mapPos[u.current][0],u.mapPos[u.current][1]],[u.mapPos[this.gotoSence][0],u.mapPos[this.gotoSence][1]]))}render(e){if(e.save(),this.isHoverAble&&(s.mousemovePos[0]>this.pos[0]-this.image.element.width/2&&s.mousemovePos[1]>this.pos[1]-this.image.element.height/2&&s.mousemovePos[0]<this.pos[0]+this.image.element.width/2&&s.mousemovePos[1]<this.pos[1]+this.image.element.height/2?e.globalAlpha=.7:e.globalAlpha=1),this.isChangeSenceAble&&s.clickPos[0]>this.pos[0]-this.image.element.width/2&&s.clickPos[1]>this.pos[1]-this.image.element.height/2&&s.clickPos[0]<this.pos[0]+this.image.element.width/2&&s.clickPos[1]<this.pos[1]+this.image.element.height/2){let e=0;s.clickPos=[0,0],u.current!==this.gotoSence&&(e=this.calculateCost([u.mapPos[u.current][0],u.mapPos[u.current][1]],[u.mapPos[this.gotoSence][0],u.mapPos[this.gotoSence][1]])/2),a.minute+=e,i.current=this.gotoSence,u.current=this.gotoSence}e.drawImage(this.image.element,this.pos[0]-this.image.element.width/2+4,this.pos[1]-this.image.element.height/2+2),e.restore()}}class w{constructor(){this._menu=new p([0,0],"",void 0,void 0,void 0,""),this.home=new p([172,438],"./Media/Image/MapIcon/home.png",!0,!0,i.home,"Home"),this._map=new p([0,0],""),this.river=new p([128,553],"./Media/Image/MapIcon/river.png",!0,!0,i.river,"River"),this.jungle=new p([102,245],"./Media/Image/MapIcon/jungle.png",!0,!0,i.jungle,"Jungle"),this.waterfall=new p([322,194],"./Media/Image/MapIcon/waterfall.png",!0,!0,i.waterfall,"Waterfall")}render(e){this.home.render(e),this.river.render(e),this.jungle.render(e),this.waterfall.render(e)}}class v{constructor(){this.background=new t(0,0,"./Media/Image/Backgrounds/map.png"),this.mapIcons=new w,this.redDot=new I(100,100)}render(e){this.background.render(e),this.mapIcons.render(e),this.redDot.render(e)}}class I{constructor(t,s){this.imageURL="./Media/Image/UI/red-dot.png",this.pos=[t,s],this.image=new e(this.imageURL)}render(e){e.drawImage(this.image.element,u.mapPos[u.current][0],u.mapPos[u.current][1])}}class P{constructor(){this.background=new t(0,0,"./Media/Image/Backgrounds/waterfall.png"),this.leaveArrow=new c(70,220,"./Media/Image/UI/Leave-Arrow.png",!0,void 0,void 0,void 0,!0,2)}render(e){this.background.render(e),this.leaveArrow.render(e)}}class b{constructor(){this.background=new t(0,0,"./Media/Image/Backgrounds/jungle.png"),this.leaveArrow=new c(70,220,"./Media/Image/UI/Leave-Arrow.png",!0,void 0,void 0,void 0,!0,2)}render(e){this.background.render(e),this.leaveArrow.render(e)}}class f{constructor(){this.background=new t(0,0,"./Media/Image/Backgrounds/river.png"),this.leaveArrow=new c(70,220,"./Media/Image/UI/Leave-Arrow.png",!0,void 0,void 0,void 0,!0,2)}render(e){this.background.render(e),this.leaveArrow.render(e)}}class M{constructor(t=[50,150],s="./Media/Image/UI/Panel.png",i=[320,175]){this.xImageURL="./Media/Image/UI/x.png",this.pos=[t[0],t[1]],this.imageURL=s,this.image=new e(s),this.customXPos=i,this.xButton=new c(i[0],i[1],this.xImageURL,!0,"",!0,g.none,!1,void 0,"x")}render(e){e.drawImage(this.image.element,this.pos[0],this.pos[1]),this.xButton.render(e)}}class A extends M{constructor(){super([10,200],"./Media/Image/UI/Guide-Panel.png",[373,225])}prevPage(){}nextPage(){}render(e){super.render(e)}}class k extends M{constructor(){super()}render(e){super.render(e)}}class S{}S.current=0;class U{constructor(t,s){this.item=s,this.pos=t,this.image=new e(s.imageURL)}render(e){e.save(),e.fillStyle="rgba(0, 0, 0, 0.411)",e.fillRect(this.pos[0],this.pos[1],50,50),e.restore(),e.drawImage(this.image.element,this.pos[0]+5,this.pos[1]+5,40,40)}}class x{constructor(e,t,s,i="",n=!1,r=[0,0,0,0]){this.text=i,this.consumable=n,this.attrValue=r,this.name=e,this.imageURL=t,this.ID=s}}const B=1,L=2,y=3,R=4,C=101;class j{constructor(){this.items=[],this.items.push(new x("Banana","./Media/Image/Items/Banana.png",B,"A Banana",!0,[0,10,5,0])),this.items.push(new x("Coconut","./Media/Image/Items/Coconut.png",L,"A Coconut",!0,[0,10,20,0])),this.items.push(new x("Berry","./Media/Image/Items/Berry.png",y,"A Berry",!0,[0,5,5,0])),this.items.push(new x("Fish","./Media/Image/Items/Fish.png",R,"A Fish",!0,[0,5,5,0])),this.items.push(new x("Passport","./Media/Image/Items/Passport.png",C,"My Passport")),this.Debug()}findOne(e){return this.items.find((t=>t.ID===e))}Debug(){const e=this.items.find((e=>"Passport"===e.name));console.table(this.items),console.table(e)}}let H=[];class O{constructor(e){this.items=[],H.push(e.findOne(B)),H.push(e.findOne(y)),H.push(e.findOne(C)),H.push(e.findOne(L))}}class ${constructor(e){this.itemBoxs=[],this.boxPos=[[70,220]],this.items=e,this.page=S.current,this.itemSystem=new O(e);for(const e in H){const t=new U(this.boxPos[e],H[e]);this.itemBoxs.push(t),this.boxPos.push([this.boxPos[e][0]+70,this.boxPos[e][1]])}}render(e){for(const t in this.itemBoxs)this.itemBoxs[t].render(e)}}class F{constructor(e){this.systemItems=e,this.guide=new A,this.bag=new k,this.itemBoxs=new $(e)}render(e){g.current===g.guide&&this.guide.render(e),g.current===g.bag&&(this.bag.render(e),this.itemBoxs.render(e))}}class D{constructor(){this.attrs=new h,this.timer=new m,this.guide=new l,this.items=new j,this.panels=new F(this.items),this.menu=new r,this.home=new d,this.map=new v,this.river=new f,this.jungle=new b,this.waterfall=new P}render(e){i.current===i.menu&&this.menu.render(e),i.current===i.home&&this.home.render(e),i.current===i.map&&this.map.render(e),i.current===i.river&&this.river.render(e),i.current===i.jungle&&this.jungle.render(e),i.current===i.waterfall&&this.waterfall.render(e),i.current!==i.menu&&(this.attrs.render(e),this.timer.render(e),this.guide.render(e),this.panels.render(e))}}class N{}N.styleCursor="default";const T=document.getElementById("gameCanvas"),_=T.getContext("2d");N.width=T.width,N.height=T.height;const G=new s;G.clickListener(T),G.mouseoverListener(T);const E=new class{constructor(){this.Sences=new D}render(e){this.Sences.render(e)}},V=new class{constructor(){this.fps=0,this.times=[]}render(e){const t=performance.now();for(;this.times.length>0&&this.times[0]<=t-1e3;)this.times.shift();this.times.push(t),this.fps=this.times.length,e.textAlign="center",e.font="20px Poppins",e.fillStyle="#F3FF0F",e.fillText(this.fps.toString(),20,20)}},X=()=>{E.render(_),V.render(_),requestAnimationFrame(X)};setInterval((()=>{a.minute%1440==0&&a.day++,a.minute++}),500),X()})();